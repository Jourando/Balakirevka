	if (ISSET($_GET['out'])) {
			$filename=$_GET['out'];
	} else {
			$filename='';
	}
    header("Content-Type: application/force-download");
    header("Content-Type: application/octet-stream");
    header("Content-Type: application/download");;
    header("Content-Disposition: attachment;filename=".($filename!=''?$filename:'file.xls'));
    header("Content-Transfer-Encoding: binary");
    xlsBOF(); //пишем начало файла
    for($i=0,$counti=count($array);$i<$counti;$i++){ //количество строк
        for($j=0,$countj=count($array[$i]);$j<$countj;$j++){ //количество €чеек
			// если колонка = [список колонок, которые отдаютс€ как числовые], то xlsWriteNumber
			// иначе...
            xlsWriteLabel($i,$j, chCode1($array[$i][$j])); 
			//в строку $i в €чейку $j, записываем конвертированное в 1251 содержимое $array[$i][$j]
        }
    }
    xlsEOF(); // закрываем файл